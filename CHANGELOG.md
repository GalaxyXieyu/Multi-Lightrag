# 更新日志 (CHANGELOG)

> 🌟 **LightRAG Enhanced** - 基于 [HKUDS/LightRAG](https://github.com/HKUDS/LightRAG) 的重构增强版本

## [v1.3.10-enhanced] - 2025-07-28 🚀 **重构发布版**

### 🎯 **重构核心特性**
- **🔄 多图谱架构支持** - 完整的多图谱管理系统，支持动态切换和状态管理
- **🧠 智能实体合并系统** - 基于 embedding 相似度的智能实体去重和合并
- **📊 图谱状态指示器** - 实时显示图谱状态、实体数量和活跃状态
- **🔍 跨图谱检索** - 支持指定图谱进行精准检索
- **⚡ 异步批处理** - 高效的批量实体合并处理
- **💾 智能缓存系统** - 支持 embedding 缓存和相似度阈值控制

### ✨ 新增功能
- **多图谱检索支持** - 检索功能现在支持指定图谱进行查询
- **图谱切换监听** - 图谱切换时自动显示系统提示消息
- **增强的错误处理** - 未选择图谱时显示友好提示
- **实体合并API** - 提供完整的实体合并接口和策略配置

### 🔧 改进优化
- **界面视觉优化** - 图谱选择器增加绿色/黄色状态指示
- **用户体验提升** - 图谱切换时的实时状态同步
- **参数面板优化** - 显示图谱实体数量和活跃状态
- **响应式设计** - 优化移动端图谱选择体验

### 🐛 问题修复
- **修复500错误** - 解决 `'NoneType' object has no attribute 'current_rag'` 错误
- **修复变量重复声明** - 解决前端构建时的TypeScript错误
- **修复状态同步** - 确保多个组件间的图谱状态一致性
- **修复API调用** - 正确传递图谱ID参数到后端

### 📝 技术改动

#### 前端 (lightrag_webui)
- `src/features/RetrievalTesting.tsx` - 添加图谱切换监听和状态检查
- `src/components/retrieval/QuerySettings.tsx` - 优化图谱显示界面
- `src/api/lightrag.ts` - API调用支持图谱ID参数

#### 后端 (lightrag)
- `api/routers/query_routes.py` - 修复_graph_manager空值检查
- 增强错误处理和日志记录

### 📖 文档更新
- 新增 `docs/multi-graph-adaptation.md` - 完整的多图谱适配开发文档
- 更新 `lightrag_webui/README.md` - 添加多图谱功能说明
- 包含AI提示词配置、技术实现细节、测试策略等

### 🚀 使用说明

#### 快速开始
```bash
# 1. 激活环境并安装依赖
conda activate lightrag
pip install -e ".[api]"

# 2. 构建前端
cd lightrag_webui && npm run build && cd ..

# 3. 启动服务器
lightrag-server

# 4. 访问界面
open http://127.0.0.1:9621/webui/
```

#### 多图谱检索流程
1. 在图谱选择器中选择或创建图谱
2. 上传文档到指定图谱
3. 切换到检索页面
4. 确认当前图谱指示器显示正确
5. 输入查询内容进行检索

### 🔍 测试验证
- ✅ 图谱创建和切换功能
- ✅ 多图谱检索功能
- ✅ 错误处理和用户提示
- ✅ 界面响应性和状态同步
- ✅ API调用和参数传递

### 👥 贡献者
- AI Assistant - 主要开发和文档编写
- 用户反馈 - 功能需求和测试验证

---

## 🔄 **重构历史**

### [v1.3.9] - 2025-07-27 (原版本基础)
- 基础的图谱管理功能
- 单图谱检索支持
- 文档上传和处理

### [v1.0.0 - v1.3.8] - 原始版本历史
基于 [HKUDS/LightRAG](https://github.com/HKUDS/LightRAG) 的原始实现：
- ✅ 基础 RAG 功能
- ✅ 知识图谱构建
- ✅ 向量检索
- ✅ LLM 集成
- ✅ Web 界面

## 🎯 **重构对比**

| 功能特性 | 原版本 | 重构版本 |
|----------|--------|----------|
| 图谱支持 | ❌ 单图谱 | ✅ 多图谱动态管理 |
| 实体合并 | ❌ 基础去重 | ✅ 智能embedding合并 |
| 界面体验 | ❌ 基础界面 | ✅ 现代化响应式设计 |
| 状态管理 | ❌ 简单状态 | ✅ 实时状态同步 |
| API数量 | ❌ 基础API | ✅ 24个完整API端点 |

---

**📝 说明**: 本重构版本基于 [HKUDS/LightRAG](https://github.com/HKUDS/LightRAG) v1.3.9，专注于多图谱架构和智能实体合并功能的深度优化。
