# 右键菜单功能测试指南

## 🔧 问题修复

刚才的问题是：**GraphEvents组件只有在启用节点拖拽时才会渲染**，导致右键菜单功能无法使用。

### ✅ 已修复的问题
1. **GraphEvents组件现在总是渲染**，不再依赖拖拽设置
2. **拖拽功能独立控制**，通过`enableNodeDrag`设置控制
3. **右键菜单功能独立工作**，不受拖拽设置影响

## 🧪 测试步骤

### 1. 刷新页面
- 确保加载最新的JavaScript文件
- 清除浏览器缓存（如果需要）

### 2. 测试节点右键菜单
1. **在任意节点上右键点击**
2. **应该看到自定义菜单**，而不是浏览器原生菜单
3. **菜单内容应该包括**：
   - ✏️ 编辑节点名称
   - 🗑️ 删除节点

### 3. 测试关系右键菜单
1. **在任意关系线上右键点击**
2. **应该看到自定义菜单**
3. **菜单内容应该包括**：
   - 🗑️ 删除关系

### 4. 测试菜单功能
1. **编辑节点名称**：
   - 右键节点 → 编辑节点名称
   - 应该弹出现代化的输入对话框
   - 输入新名称并确认

2. **删除节点**：
   - 右键节点 → 删除节点
   - 应该弹出确认对话框
   - 确认后节点应该从图谱中消失

3. **删除关系**：
   - 右键关系线 → 删除关系
   - 应该弹出确认对话框
   - 确认后关系线应该消失

## 🚨 如果右键菜单仍然不显示

### 检查浏览器控制台
1. 按 `F12` 打开开发者工具
2. 查看 Console 标签页
3. 查找任何错误信息

### 检查设置
1. 确认图谱页面已完全加载
2. 确认有节点和关系显示在图谱中
3. 尝试在不同的节点上右键点击

### 强制刷新
1. 按 `Ctrl+F5` (Windows) 或 `Cmd+Shift+R` (Mac)
2. 或者清除浏览器缓存后重新访问

## 🎯 预期行为

### ✅ 正确的行为
- 右键点击节点/关系时显示自定义菜单
- 菜单有现代化的样式（白色背景，圆角，阴影）
- 点击菜单项会执行相应功能
- 点击空白区域会关闭菜单

### ❌ 错误的行为
- 显示浏览器原生右键菜单（图片存储、复制图片等）
- 右键点击没有任何反应
- 菜单显示但点击无效果

## 🔍 调试信息

如果问题仍然存在，请检查以下内容：

### 1. 控制台日志
```javascript
// 应该能看到这些日志
console.log('Initialized sigma settings')
console.log('Setting sigma instance from GraphControl')
```

### 2. 事件绑定
在浏览器控制台中运行：
```javascript
// 检查sigma实例是否存在
window.sigma = document.querySelector('canvas')?._sigma
console.log('Sigma instance:', window.sigma)
```

### 3. 手动测试
在控制台中运行：
```javascript
// 手动触发右键菜单测试
console.log('Right click events should be registered')
```

## 📞 如果仍有问题

请提供以下信息：
1. 浏览器类型和版本
2. 控制台错误信息截图
3. 右键点击时的具体行为描述
4. 是否能看到图谱中的节点和关系

---

💡 **提示**：确保在节点的中心位置右键点击，而不是在节点边缘或空白区域。
